<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>Update Item</title>
</head>

<body>
    <h1>Update Item</h1>
    <form id="updateForm">
        <label for="table">Select Table:</label>
        <select id="table" name="table">
            <option value="cpu">CPU</option>
            <option value="gpu">GPU</option>
            <option value="ram">RAM</option>
            <option value="mom">Motherboard</option>
            <option value="storage">Storage</option>
            <option value="psu">PSU</option>
            <option value="case">Case</option>
            <!-- Add other table options here -->
        </select>
    </form>

    <div id="tableContainer">
        <!-- Table will be populated dynamically -->
    </div>

    <script>
        function populateTable() {
            var tableSelect = document.getElementById("table");
            var selectedTable = tableSelect.value;
            var tableContainer = document.getElementById("tableContainer");
            tableContainer.innerHTML = ""; // Clear previous table

            // Fetch data for the selected table using Flask route
            fetch(`/get_options/${selectedTable}`)
                .then(response => response.json())
                .then(data => {
                    // Create and populate the table
                    var table = document.createElement("table");
                    var headerRow = table.insertRow();
                    Object.keys(data[0]).forEach(key => {
                        var headerCell = headerRow.insertCell();
                        headerCell.textContent = key.charAt(0).toUpperCase() + key.slice(1);
                    });

                    data.forEach(item => {
                        var row = table.insertRow();
                        Object.values(item).forEach(value => {
                            var cell = row.insertCell();
                            cell.textContent = value;
                        });

                        // Add update button column
                        var updateCell = row.insertCell();
                        var updateButton = document.createElement("button");
                        updateButton.textContent = "Update";
                        updateButton.className = "update-button";
                        updateButton.onclick = function() {
                            // Add your update logic here, e.g., redirect to update page with item ID
                            alert("Update item ID: " + item.id);
                        };
                        updateCell.appendChild(updateButton);
                    });

                    tableContainer.appendChild(table);
                })
                .catch(error => {
                    console.error('Error fetching table data:', error);
                });
        }

        // Call populateTable initially to populate the table based on the default selected table
        populateTable();

        // Add event listener to re-populate table on table selection change
        document.getElementById("table").addEventListener("change", populateTable);
    </script>
</body>

</html>
